<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Read records from a REDCap project in subsets, and stacks them
together before returning a dataset — redcap_read • REDCapR</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>



<meta property="og:title" content="Read records from a REDCap project in subsets, and stacks them
together before returning a dataset — redcap_read" />
<meta property="og:description" content="From an external perspective, this function is similar to
redcap_read_oneshot().  The internals differ in that redcap_read
retrieves subsets of the data, and then combines them before returning
(among other objects) a single base::data.frame().  This function can
be more appropriate than redcap_read_oneshot() when returning large
datasets that could tie up the server." />
<meta property="og:image" content="https://ouhscbbmc.github.io/REDCapR/logo.svg" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">REDCapR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.11.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/OuhscBbmc/REDCapR/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Read records from a REDCap project in subsets, and stacks them
together before returning a dataset</h1>
    <small class="dont-index">Source: <a href='https://github.com/OuhscBbmc/REDCapR/blob/master/R/redcap-read.R'><code>R/redcap-read.R</code></a></small>
    <div class="hidden name"><code>redcap_read.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>From an external perspective, this function is similar to
<code><a href='redcap_read_oneshot.html'>redcap_read_oneshot()</a></code>.  The internals differ in that <code>redcap_read</code>
retrieves subsets of the data, and then combines them before returning
(among other objects) a single <code><a href='https://rdrr.io/r/base/data.frame.html'>base::data.frame()</a></code>.  This function can
be more appropriate than <code><a href='redcap_read_oneshot.html'>redcap_read_oneshot()</a></code> when returning large
datasets that could tie up the server.</p>
    </div>

    <pre class="usage"><span class='fu'>redcap_read</span>(
  <span class='kw'>batch_size</span> <span class='kw'>=</span> <span class='fl'>100L</span>,
  <span class='kw'>interbatch_delay</span> <span class='kw'>=</span> <span class='fl'>0.5</span>,
  <span class='kw'>continue_on_error</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='no'>redcap_uri</span>,
  <span class='no'>token</span>,
  <span class='kw'>records</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>records_collapsed</span> <span class='kw'>=</span> <span class='st'>""</span>,
  <span class='kw'>fields</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>fields_collapsed</span> <span class='kw'>=</span> <span class='st'>""</span>,
  <span class='kw'>forms</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>forms_collapsed</span> <span class='kw'>=</span> <span class='st'>""</span>,
  <span class='kw'>events</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>events_collapsed</span> <span class='kw'>=</span> <span class='st'>""</span>,
  <span class='kw'>raw_or_label</span> <span class='kw'>=</span> <span class='st'>"raw"</span>,
  <span class='kw'>raw_or_label_headers</span> <span class='kw'>=</span> <span class='st'>"raw"</span>,
  <span class='kw'>export_checkbox_label</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>export_survey_fields</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>export_data_access_groups</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>filter_logic</span> <span class='kw'>=</span> <span class='st'>""</span>,
  <span class='kw'>col_types</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>guess_type</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>guess_max</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>config_options</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>id_position</span> <span class='kw'>=</span> <span class='fl'>1L</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>batch_size</th>
      <td><p>The maximum number of subject records a single batch
should contain.  The default is 100.</p></td>
    </tr>
    <tr>
      <th>interbatch_delay</th>
      <td><p>The number of seconds the function will wait
before requesting a new subset from REDCap. The default is 0.5 seconds.</p></td>
    </tr>
    <tr>
      <th>continue_on_error</th>
      <td><p>If an error occurs while reading, should records
in subsequent batches be attempted.  The default is <code>FALSE</code>, which prevents
subsequent batches from running.  Required.</p></td>
    </tr>
    <tr>
      <th>redcap_uri</th>
      <td><p>The URI (uniform resource identifier) of the REDCap
project.  Required.</p></td>
    </tr>
    <tr>
      <th>token</th>
      <td><p>The user-specific string that serves as the password for a
project.  Required.</p></td>
    </tr>
    <tr>
      <th>records</th>
      <td><p>An array, where each element corresponds to the ID of a
desired record.  Optional.</p></td>
    </tr>
    <tr>
      <th>records_collapsed</th>
      <td><p>A single string, where the desired ID values are
separated by commas.  Optional.</p></td>
    </tr>
    <tr>
      <th>fields</th>
      <td><p>An array, where each element corresponds to a desired project
field.  Optional.</p></td>
    </tr>
    <tr>
      <th>fields_collapsed</th>
      <td><p>A single string, where the desired field names are
separated by commas.  Optional.</p></td>
    </tr>
    <tr>
      <th>forms</th>
      <td><p>An array, where each element corresponds to a desired project
form.  Optional.</p></td>
    </tr>
    <tr>
      <th>forms_collapsed</th>
      <td><p>A single string, where the desired form names are
separated by commas.  Optional.</p></td>
    </tr>
    <tr>
      <th>events</th>
      <td><p>An array, where each element corresponds to a desired project
event.  Optional.</p></td>
    </tr>
    <tr>
      <th>events_collapsed</th>
      <td><p>A single string, where the desired event names are
separated by commas.  Optional.</p></td>
    </tr>
    <tr>
      <th>raw_or_label</th>
      <td><p>A string (either <code>'raw'</code> or <code>'label'</code> that specifies
whether to export the raw coded values or the labels for the options of
multiple choice fields.  Default is <code>'raw'</code>.</p></td>
    </tr>
    <tr>
      <th>raw_or_label_headers</th>
      <td><p>A string (either <code>'raw'</code> or <code>'label'</code> that
specifies for the CSV headers whether to export the variable/field names
(raw) or the field labels (label).  Default is <code>'raw'</code>.</p></td>
    </tr>
    <tr>
      <th>export_checkbox_label</th>
      <td><p>specifies the format of checkbox field values
specifically when exporting the data as labels.  If <code>raw_or_label</code> is
<code>'label'</code> and <code>export_checkbox_label</code> is TRUE, the values will be the text
displayed to the users.  Otherwise, the values will be 0/1.</p></td>
    </tr>
    <tr>
      <th>export_survey_fields</th>
      <td><p>A boolean that specifies whether to export the
survey identifier field (e.g., 'redcap_survey_identifier') or survey
timestamp fields (e.g., instrument+'_timestamp') .</p></td>
    </tr>
    <tr>
      <th>export_data_access_groups</th>
      <td><p>A boolean value that specifies whether or
not to export the <code>redcap_data_access_group</code> field when data access groups
are utilized in the project. Default is <code>FALSE</code>. See the details below.</p></td>
    </tr>
    <tr>
      <th>filter_logic</th>
      <td><p>String of logic text (e.g., <code>[gender] = 'male'</code>) for
filtering the data to be returned by this API method, in which the API
will only return the records (or record-events, if a longitudinal project)
where the logic evaluates as TRUE.   An blank/empty string returns all records.</p></td>
    </tr>
    <tr>
      <th>col_types</th>
      <td><p>A <code><a href='https://readr.tidyverse.org/reference/cols.html'>readr::cols()</a></code> object passed internally to
<code><a href='https://readr.tidyverse.org/reference/read_delim.html'>readr::read_csv()</a></code>.  Optional.</p></td>
    </tr>
    <tr>
      <th>guess_type</th>
      <td><p>A boolean value indicating if all columns should be
returned as character.  If true, <code><a href='https://readr.tidyverse.org/reference/read_delim.html'>readr::read_csv()</a></code> guesses the intended
data type for each column.</p></td>
    </tr>
    <tr>
      <th>guess_max</th>
      <td><p>Deprecated.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>A boolean value indicating if <code>message</code>s should be printed
to the R console during the operation.  The verbose output might contain
sensitive information (<em>e.g.</em> PHI), so turn this off if the output might
be visible somewhere public. Optional.</p></td>
    </tr>
    <tr>
      <th>config_options</th>
      <td><p>A list of options to pass to <code>POST</code> method in the
<code>httr</code> package.  See the details in <code><a href='redcap_read_oneshot.html'>redcap_read_oneshot()</a></code> Optional.</p></td>
    </tr>
    <tr>
      <th>id_position</th>
      <td><p>The column position of the variable that unique
identifies the subject (typically <code>record_id</code>).
This defaults to the first variable in the dataset.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Currently, a list is returned with the following elements:</p><ul>
<li><p><code>data</code>: An R <code><a href='https://rdrr.io/r/base/data.frame.html'>base::data.frame()</a></code> of the desired records and columns.</p></li>
<li><p><code>success</code>: A boolean value indicating if the operation was apparently
successful.</p></li>
<li><p><code>status_codes</code>: A collection of
<a href='http://en.wikipedia.org/wiki/List_of_HTTP_status_codes'>http status codes</a>,
separated by semicolons.  There is one code for each batch attempted.</p></li>
<li><p><code>outcome_messages</code>: A collection of human readable strings indicating the
operations' semicolons.  There is one code for each batch attempted.  In an
unsuccessful operation, it should contain diagnostic information.</p></li>
<li><p><code>records_collapsed</code>: The desired records IDs, collapsed into a single
string, separated by commas.</p></li>
<li><p><code>fields_collapsed</code>: The desired field names, collapsed into a single
string, separated by commas.</p></li>
<li><p><code>filter_logic</code>: The filter statement passed as an argument.</p></li>
<li><p><code>elapsed_seconds</code>: The duration of the function.</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Specifically, it internally uses multiple calls to <code><a href='redcap_read_oneshot.html'>redcap_read_oneshot()</a></code>
to select and return data.  Initially, only the primary key is queried
through the REDCap API.  The long list is then subsetted into batches,
whose sizes are determined by the <code>batch_size</code> parameter.  REDCap is then
queried for all variables of the subset's subjects.  This is repeated for
each subset, before returning a unified <code><a href='https://rdrr.io/r/base/data.frame.html'>base::data.frame()</a></code>.</p>
<p>The function allows a delay between calls, which allows the server to
attend to other users' requests (such as the users entering data in a
browser).  In other words, a delay between batches does not bog down
the webserver when exporting/importing a large dataset.</p>
<p>A second benefit is less RAM is required on the webserver.  Because
each batch is smaller than the entire dataset, the webserver
tackles more manageably sized objects in memory.  Consider batching
if you encounter the error</p><pre>ERROR: REDCap ran out of server memory. The request cannot be processed.
Please try importing/exporting a smaller amount of data.
</pre>

<p>For <code>redcap_read()</code> to function properly, the user must have Export
permissions for the 'Full Data Set'.  Users with only 'De-Identified'
export privileges can still use <code>redcap_read_oneshot</code>.  To grant the
appropriate permissions:</p><ul>
<li><p>go to 'User Rights' in the REDCap project site,</p></li>
<li><p>select the desired user, and then select 'Edit User Privileges',</p></li>
<li><p>in the 'Data Exports' radio buttons, select 'Full Data Set'.</p></li>
</ul>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>The official documentation can be found on the 'API Help Page'
and 'API Examples' pages on the REDCap wiki (<em>i.e.</em>,
https://community.projectredcap.org/articles/456/api-documentation.html
and
https://community.projectredcap.org/articles/462/api-examples.html).
If you do not have an account for the wiki, please ask your campus REDCap
administrator to send you the static material.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='no'>uri</span>     <span class='kw'>&lt;-</span> <span class='st'>"https://bbmc.ouhsc.edu/redcap/api/"</span>
<span class='no'>token</span>   <span class='kw'>&lt;-</span> <span class='st'>"9A81268476645C4E5F03428B8AC3AA7B"</span>
<span class='kw pkg'>REDCapR</span><span class='kw ns'>::</span><span class='fu'>redcap_read</span>(<span class='kw'>batch_size</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>redcap_uri</span><span class='kw'>=</span><span class='no'>uri</span>, <span class='kw'>token</span><span class='kw'>=</span><span class='no'>token</span>)$<span class='no'>data</span>

<span class='co'># Specify the column types.</span>
<span class='no'>col_types</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>readr</span><span class='kw ns'>::</span><span class='fu'><a href='https://readr.tidyverse.org/reference/cols.html'>cols</a></span>(
  <span class='kw'>record_id</span>  <span class='kw'>=</span> <span class='kw pkg'>readr</span><span class='kw ns'>::</span><span class='fu'><a href='https://readr.tidyverse.org/reference/parse_atomic.html'>col_integer</a></span>(),
  <span class='kw'>race___1</span>   <span class='kw'>=</span> <span class='kw pkg'>readr</span><span class='kw ns'>::</span><span class='fu'><a href='https://readr.tidyverse.org/reference/parse_atomic.html'>col_logical</a></span>(),
  <span class='kw'>race___2</span>   <span class='kw'>=</span> <span class='kw pkg'>readr</span><span class='kw ns'>::</span><span class='fu'><a href='https://readr.tidyverse.org/reference/parse_atomic.html'>col_logical</a></span>(),
  <span class='kw'>race___3</span>   <span class='kw'>=</span> <span class='kw pkg'>readr</span><span class='kw ns'>::</span><span class='fu'><a href='https://readr.tidyverse.org/reference/parse_atomic.html'>col_logical</a></span>(),
  <span class='kw'>race___4</span>   <span class='kw'>=</span> <span class='kw pkg'>readr</span><span class='kw ns'>::</span><span class='fu'><a href='https://readr.tidyverse.org/reference/parse_atomic.html'>col_logical</a></span>(),
  <span class='kw'>race___5</span>   <span class='kw'>=</span> <span class='kw pkg'>readr</span><span class='kw ns'>::</span><span class='fu'><a href='https://readr.tidyverse.org/reference/parse_atomic.html'>col_logical</a></span>(),
  <span class='kw'>race___6</span>   <span class='kw'>=</span> <span class='kw pkg'>readr</span><span class='kw ns'>::</span><span class='fu'><a href='https://readr.tidyverse.org/reference/parse_atomic.html'>col_logical</a></span>()
)
<span class='kw pkg'>REDCapR</span><span class='kw ns'>::</span><span class='fu'>redcap_read</span>(
  <span class='kw'>redcap_uri</span> <span class='kw'>=</span> <span class='no'>uri</span>,
  <span class='kw'>token</span>      <span class='kw'>=</span> <span class='no'>token</span>,
  <span class='kw'>col_types</span>  <span class='kw'>=</span> <span class='no'>col_types</span>,
  <span class='kw'>batch_size</span> <span class='kw'>=</span> <span class='fl'>2</span>
)$<span class='no'>data</span>

}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Will Beasley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: 'd672935e2d904316d6ee40239317764e',
    indexName: 'redcapr',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


